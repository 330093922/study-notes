# 面试错题集合

## 1 Java

### 1.1 基础

1. 【不合格】说说 JDK 和 JRE 分别是什么？还有它们的区别？

答：JDK 是 java 开发工具包；JRE 是 java 运行时环境。

区别：

- JRE 包含了 java 虚拟机，java 基础类库；
- JDK 包含 JRE，同时还包含了编译 java 源码的编译器 javac，还包含了很多 java 程序调试和分析的工具：jconsole，jvisualvm 等工具软件，还包含了 java 程序编写所需的文档和 demo 例子程序。

2. 【不合格】equals 底层怎么实现的？你自定义一个类如何去重写 equals ？

答：底层实现如下（Object 类中）：

````java
public boolean equals(Object obj) {
    return (this == obj);
}
````

拿 HashMap 来举例，HashMap 的 equals 方法实现如下（先比较入参对象是否等于当前对象 this，再判断对象 instanceof 当前类后，比较内部属性，一样返回 true，不一样则返回 false）：

````java
public final boolean equals(Object o) {
    if (o == this)
        return true;
    if (o instanceof Map.Entry) {
        Map.Entry<?,?> e = (Map.Entry<?,?>)o;
        if (Objects.equals(key, e.getKey()) &&
            Objects.equals(value, e.getValue()))
            return true;
    }
    return false;
}
````

3. 【不合格】说一下 final 关键字的作用。

答：①被 final 修饰的类，表明该类是无法继承的；

​		②被 final 修饰的方法，表明该方法是无法覆写的；

​		③被 final 修饰的变量，说明该变量在声明的时候，必须初始化完成，而且以后也不能修改其内存地址。

4. 【盲区】static 是线程安全的吗？

答：①当 static 修饰类变量时，线程不安全；

​		②当 static 修饰方法时，static 方法内部的变量在执行时，线程安全（方法执行时，数据运行在栈里面，栈的数据每个线程都是隔离开的，所以不会有线程安全的问题）；

​		③当 static 修饰代码块时，线程安全。

5. 【盲区】枚举是线程安全的吗？如果是，那是如何保证线程安全的？

答：枚举是线程安全的。

简单一个枚举类：

````java
public enum t {
    SPRING,SUMMER,AUTUMN,WINTER;
}
````

枚举类生成的字节码文件反编译后：

````java
public final class T extends Enum {
    private T(String s, int i)  {
        super(s, i);
    }
    public static T[] values() {
        T at[];
        int i;
        T at1[];
        System.arraycopy(at = ENUM$VALUES, 0, at1 = new T[i = at.length], 0, i);
        return at1;
    }
 
    public static T valueOf(String s) {
        return (T)Enum.valueOf(demo/T, s);
    }
 
    public static final T SPRING;
    public static final T SUMMER;
    public static final T AUTUMN;
    public static final T WINTER;
    private static final T ENUM$VALUES[];
    static {
        SPRING = new T("SPRING", 0);
        SUMMER = new T("SUMMER", 1);
        AUTUMN = new T("AUTUMN", 2);
        WINTER = new T("WINTER", 3);
        ENUM$VALUES = (new T[] {
            SPRING, SUMMER, AUTUMN, WINTER
        });
    }
}
````

枚举类编译后的类是继承了 Enum 类，且被 final 修饰，不可被继承，属性和其创建类的方式都是 static 修饰的，当一个 Java 类第一次被真正使用到的时候静态资源被初始化、Java类的加载和初始化过程都是线程安全的，所以创建一个 enum 类型是线程安全的。

### 1.2 集合

1. 【记错】HashMap 的键和值能不能为 null？

答：都能。

2. 【盲区】HashMap 从红黑树退化为链表的临界值为什么是6，而不是7？

答：抖动问题，可能会频繁转换，因为转换会消耗资源，导致性能下降。

3. 【盲区】哪些集合类是线程安全的？

答：Collections.synchronized* 开头的类、HashTable、Vector 、CopyOnwriteArrayList 和 ConcurrentHashMap。

4. 【盲区】从设计层面说一下迭代器的设计原理。

答：

5. 【记错】Iterator 和 ListIterator 有什么区别？

答：

### 1.3 多线程

1. 【不合格】线程和进程的区别？CPU 调度和分派主要关注哪一个？

答：区别：

线程是被 CPU 调度和分派的基本单位。

2. 【不合格】解释一下多线程的概念。

答：

3. 【记错】并行和并发有什么区别？

答：

4. 【盲区】解释一下守护线程的概念。常见的守护线程有哪些？举几个例子。

答：守护线程是指为其他线程服务的线程。在JVM中，所有非守护线程都执行完毕后，无论有没有守护线程，虚拟机都会自动退出。

常见的守护线程有垃圾回收线程（GC）和 Docker 的 Daemon 线程。

5. 【不合格】说一下创建线程有哪几种方式？

答：

6. 【盲区】说一下有哪几类线程池？分别用在什么场景？

答：

7. 【盲区】线程池有哪几种状态？说一下分别表示什么含义。

答：RUNNING、SHUTDOWN、STOP、TIDYING 和 TERMINATED。

含义：

- 

8. 【盲区】怎么防止线程死锁？

答：保证加锁的顺序性；超时释放锁并尝试重新获取锁。

9. 【盲区】ThreadLocal 了解吗？都用在什么场景？

答：

10. 【盲区】悲观锁对多线程的竞争性有什么影响？

### 1.4 I/O

1. 【不合格】分别说一下 BIO、NIO 和 AIO 以及他们的区别。

答：

### 1.5 JVM

1. 【盲区】JVM 是如何运行的？

答：JVM 运行分为三个步骤：加载 → 连接 → 初始化。

其中连接步骤分为三个阶段：验证 → 准备 → 解析。

总的就是：加载 → 验证 → 准备 → 解析 → 初始化。

2. 【盲区】将 CMS 回收器切换为 G1 的 JVM 参数是什么？

答：`-XX:+UseG1GC`

3. 【不合格】CMS 和 G1 对比，哪一个好？为什么？

答：

4. 【记错】永久代在 jdk 不同版本的实现方式有什么不一样？

答：

5. 【遗忘】类的静态全局变量和非静态全局变量，分别存在 JVM 哪个结构里？

答：类的静态全局变量存储在方法区；类的非静态全局变量存储在堆。

> ①方法体中的引用变量和基本类型的变量都在栈上，其他都在堆上；
>
> ②对于局部变量，如果是基本类型，会把值直接存储在栈；如果是引用类型，比如 `String s = new String("william");` 会把其对象存储在堆，而把这个对象的引用（指针）存储在栈。

6. 【不合格】Java 虚拟机栈中的栈帧的作用是什么？

答：每个方法被调用至执行完毕的过程，对应一个栈帧在虚拟机中从入栈到出栈的过程。用于存储数据：局部变量表、操作数栈、动态连接和方法出口。

7. 【不合格】说一下年轻代回收（Minor GC/Young GC）机制在没有指定回收方式时用的什么机制？

## 2 框架

### 2.1 Spring

1. 【盲区】Spring 有哪些类型的 advice？

答：

2. 【不合格】Spring 的原理说一下。

答：

3. 【盲区】Spring 的 @Autowired 是如何工作的？

答：

4. 【不合格】说一下你了解的 Spring 的核心组件。

答：

5. 【不合格】说一下 IOC 和 AOP 的区别和它们的实现原理。

答：

6. 【盲区】Spring 的单例 bean 是线程安全的吗？

答：

7. 【盲区】Spring 中 bean 的五种作用域有哪些？

答：bean 的五种作用域：

- singleton：单例 bean 实例
- prototype：每次请求会创建一个新的 bean 实例
- request：每次 HTTP 请求会创建一个新的 bean， 该 bean 仅在当前 HTTP request 内有效
- session：每次 HTTP 请求会创建一个新的 bean， 该 bean 仅在当前 HTTP session 内有效
- global-session：全局 session 作用域（Spring5 已弃用）

8. 【】

### 2.2 SpringMVC

1. 【不合格】SpringMVC 的注解有哪些？

答：

2. 【遗忘】简单描述一下一个请求经过 SpringMVC 到返回一个响应的流程。

答：

3. 【盲区】说一下 SpringMVC 的 RequestMapping 的原理。

答：

### 2.3 SpringBoot

1. 【盲区】说一下 SpringBoot 自动装配原理。

答：

2. 【不合格】说一下 SpringBoot 相比传统的 Spring、SpringMVC 有哪些优势？

答：

### 2.4 Mybatis

1. 【不合格】用 Mybatis 如何实现批量更新？

答：

2. 【遗忘】Mybatis 如何实现类似 if else 的需求？

答：xml 代码如下：（choose 是一个整体，when 对应 if，otherwise 对应 else）

````xml
<choose>
    <when test="">
        //...
    </when>
    <otherwise>
        //...
    </otherwise>
</choose>
````

3. 【盲区】Mybatis 如何将 xml 解析成一个完整的 DAO 对象去被使用的？

答：

### 2.5 OAuth2

1. 【盲区】Oauth2 如何实现的？

### 2.6 Netty

1. 【不合格】为什么 Netty 要提供这四种编解码器？

答：

2. 【不合格】Netty 如何处理半包、粘包和拆包？

答：

3. 【盲区】Netty 是如何解决多线程之间通信问题的？

答：

4. 【盲区】Netty 里如何监听一个线程执行完成的?

答：

### 2.7 Redis

1. 【记错】Redis 基本数据类型有哪些？分别适用于什么场景？

答：基本数据类型有5种：

- string，适用于key-value形式的场景，如用户token信息等
- hash，适用于带属性的对象信息，如热点订单
- list，适用于粉丝列表、文章评论，如微博下拉加载
- set，适用场景：交集（sinter x y），如共同好友；差集（sdiff x y），如可能认识的好友
- sorted set，适用于各类排行榜

高级数据类型有4种：

- bitmap
- hyperloglog
- GEO
- stream

2. 【不合格】都说 Redis 快，Redis 为什么这么快？

答：

3. 【不合格】怎样把数据一张表一次性加载到 redis 内存里？

答：加载方式：

两种方式：一种是 Redis 提供的管道（Pipeline）方式 `--pipe`，还有一种是 Lua 脚本方式。

数据存放方式：

适合存储行的数据结构有两种：string 和 hash。以 string 类型存储的话需要把数据库每行都转换为 json，比较节省内存；以 hash 存储的话对里面的部分字段进行操作会比较方便。

4. 【盲区】说一下缓存雪崩、缓存穿透和缓存击穿的含义和对应的解决方案。

答：详见 `面试专题\缓存中间件\Redis总结.md` 的 `7 常见的Redis场景问题` 章节。

### 2.8 RabbitMQ

1. 【盲区】说一下 RabbitMQ 的4种路由方式。

答：有4种不同的交换机类型：直连交换机（Direct exchange）、扇形交换机（Fanout exchange）、主题交换机（Topic exchange）和首部交换机（Headers exchange）

2. 【盲区】说一下 RabbitMQ 的消息确认机制。

答：

3. 【盲区】RabbitMQ 的生产者发送消息后，消费者收到消息时报异常，这时它是怎么处理的？这条消息会被丢失吗？

答：

4. 【盲区】描述一下 RabbitMQ 的一条消息从生产者开始到消费者消费完这期间的流程。

答：

5. 【不合格】你是如何保证消息不被重复消费的？

答：

6. 【盲区】说一下 RabbitMQ 的延迟消费队列。

答：

### 2.9 FastDFS

1. 【盲区】我想从一个服务去访问 storage 集群上的某几个 storage 服务的文件，那么 tracker 和 storage 要如何来配置？

答：

### 2.10 日志框架

1. 【盲区】你觉得 slf4j 的优势在哪里？

答：

### 2.11 Swagger

1. 【盲区】feign 里面配置了一个 controller ，我想把这个 controller 公开到 swagger 里面去，我需要在 feign 里面加标签还是 swagger 里面加配置？

## 3 网络

### 3.1 网络基础

1. 【记错】描述一下当今的网络模型分类？

答：可以分为4层：应用层、传输层、网络层和网络接口层。每层对应的协议如下：

- 应用层：TELNET，SSH，HTTP，SMTP，POP，SSL/TLS，FTP，MIME，HTML，SNMP，MIB，SIP，RTP
- 传输层：TCP，UDP，UDP-Lite，SCTP，DCCP
- 网络层：ARP，IPv4，IPv6，ICMP，IPsec
- 网络接口层：以太网，无线LAN，PPP

2. 【不合格】说一下 TCP 四次挥手过程。

答：详见 `计算机网络\TCP_IP协议\TCPIP协议.md` 的 `3 流程 —— 3.2 关闭连接（四次挥手）` 章节。

3. 【遗忘】说一下 cookie 和 session 的区别。

答：cookie数据保存在客户端，session数据保存在服务器端。

### 3.2 REST ful 接口

1. 【盲区】REST ful 含义及规范（除了GET、PUT、POST 和 DELETE 那些）？

答：

## 4 数据结构与算法

### 4.1 算法

1. 【遗忘】快速排序的基本实现？

答：设要排序的数组是A[0]……A[N-1]，首先任意选取一个数据（通常选用数组的第一个数）作为关键数据，然后将所有比它小的数都放到它前面，所有比它大的数都放到它后面，这个过程称为一趟快速排序。

## 5 分布式

### 5.1 分布式session

1. 【盲区】分布式session如何实现？

### 5.2 分布式事务

### 5.3 分布式锁

### 5.4 其他分布式问题

1. 【盲区】分布式系统里面，我如何去定位某个日志在哪台机器上？如果我只知道关键字呢？

答：

## 6 微服务

### 6.1 SpringCloud

1. 【盲区】SpringCloud 的配置中心如何进行加密？

答：**①安装 JCE**

JDK下的JCR默认是有长度限制的，需要替换没有长度限制的JCE版本。

````
http://www.oracle.com/technetwork/java/javase/downloads/jce-7-download-432124.html
````

把下载包里面的两个jar文件复制替换到JAVA_HOME/jre/lib/security目录下。

​		**②添加加密 KEY**

配置中心配置文件中加入加密密钥。

````yaml
encrypt: 
  key: 0e010e17-2529-4581-b907-c8edcfd6be09
````

​		**③验证加密功能状态**

````
http://192.168.1.158:7100/encrypt/status
````

功能正常会显示 `{"status":"OK"}` 。

​		**④加解密**

对 `develop` 字符串加密：

````shell
curl http://192.168.1.158:7100/encrypt -d  develop -u config-user:99282424-5939-4b08-a40f-87b2cbc403f6
````

对 `develop `字符串解密：

````shell
curl http://192.168.1.158:7100/decrypt -d  0fb593294187a31f35dea15e8bafaf77745328dcc20d6d6dd0dfa5ae753d6836 -u config-user:99282424-5939-4b08-a40f-87b2cbc403f6
````

> `-u username:password` 为 basic 认证。

​		**⑤配置yml文件**

````yaml
spring: 
  datasource: 
    username: '{cipher}0fb593294187a31f35dea15e8bafaf77745328dcc20d6d6dd0dfa5ae753d6836'
````

需要加密的内容以 `{cipher}` 开头，并注意要使节单引号包起来，不然报错。

​		**⑥读取配置**

这样客户端读取出来的配置是自动解密了的，如果要关闭自动解密功能通过客户端自己来解密，同时也要保留加解密的端点可以通过关闭以下配置即可。

````xml
spring.cloud.config.server.encrypt.enabled=false
````

2. 【盲区】说一下 spring cloud 的请求链路。

答：

3. 【盲区】熔断 Hystrix 的超时时间根据什么规则去设置的？

答：

4. 【盲区】注册中心如何去维持心跳的？

答：

5. 【盲区】Spring cloud netflix 和 spring cloud alibaba 有什么区别？

答：

6. 【盲区】网关如何实现限流的？

答：

	7. 【盲区】网关的作用是什么？网关的策略有哪些？

答：

8. 【盲区】gateway 怎样配置去增加一个项目？

答：

9. 【盲区】说一下 Hystrix 的熔断机制。

### 6.2 Dubbo

### 6.3 Zookeeper

1. 【盲区】Zookeeper 有哪几种选举模式？

## 7 数据库

### 7.1 MySQL

1. 【记错】MySQL 中 varchar 类型的字段，长度为50，分别能存多少个中文和英文？

答：MySQL 4.0版本以下，varchar(50)表示50字节，如果存放UTF8汉字时，只能存16个（每个汉字3字节）；MySQL 5.0版本以上，varchar(50)表示50字符，无论存放的是数字、字母还是UTF8汉字（每个汉字3字节），都可以存放50个，只是实际字节长度有所区别。

2. 【不合格】有一条 SQL 查询语句，明明建了对应查询条件的字段索引，但是它却没有走索引，可能的原因是什么？

答：

3. 【盲区】SQL 查询语句如何强制走索引？

答：SQL 语句后接下方代码（示例为强制走主键索引，走其他索引可以将 `PRIMARY` 改为对应索引名）：

````mysql
FORCE INDEX(PRIMARY)
````

4. 【记错】MySQL 的 MyISAM 存储引擎与 InnoDB 的区别？

答：

5. 【遗忘】说一下 MySQL 查询语句在 Server 层的执行流程。

答：

6. 【不合格】说一下 MySQL 事务里一致性、隔离性和原子性的含义。

答：一致性：一致性是指事务将数据库从一种一致性状态转换到另外一种一致性状态，在事务开始之前和事务结束后数据库中数据的完整性没有被破坏。

​		隔离性：隔离性要求一个事务对数据库中的数据的修改，在未提交完成前对于其他事务是不可见的。

​		SQL标准中定义的四种隔离级别：

- 未提交读（READ UNCOMMITED）（也称作脏读：通常不建议使用）

- 已提交读（READ COMMITED）（SQL Server、Oracle的默认级别，也称作不可重复读）

- 可重复读（REPEATABLE READ）（MYSQL的默认级别）

- 可串行化（SERIALIZABLE）

​		**隔离性由低到高，并发性由高到低。**

​		原子性：一个事务必须被视为一个不可分割的最小工作单元，整个事务中的所有操作要么全部提交成功，要么全部失败，对于一个事务来说，不可能只执行其中的一部分操作。

7. 【不合格】MySQL 哪些场景下索引不会生效？哪些场景下索引会生效？

答：

8. 【盲区】MySQL 有哪几种语句类型？分别是干啥的？

答：DDL（数据库定义语句）、DML（数据操纵语句）、DCL（数据控制语句）和 TCL（事务控制语句）。

9. 【不合格】分别说一下脏读、不可重复读和幻读的概念。

答：脏读：事务可以读取未提交的数据，影响的隔离级别是未提交读；

​		不可重复读：两次同样的查询，可能结果不一致，影响的隔离级别是未提交读和已提交读；

​		幻读：A事务在读取某个范围内的记录时，B事务立即在该范围内插入新数据，此时A事务再次读取该范围记录时，产生幻行，影响的隔离级别是未提交读、已提交读和可重复读。

10. 【记错】说一下 char 和 varchar 的区别。

答：①存储：

- VARCHAR类型用于存储变长字符串，只占用必要的存储空间**（单位是字符而不是字节）**；CHAR类型定长，单位是字节
- VARCHAR类型列的最大长度小于255则只占用一个额外字节用于记录字符串长度，大于则占用2个额外字节；CHAR类型最大宽度为255，且字符串存储在CHAR类型的列中会删除末尾的空格

​		②适用场景：

- VARCHAR类型适用于字符串列的最大长度比平均长度大很多、字符串列很少被更新或使用了多字节字符集存储字符串的场景
- CHAR类型适用于存储长度近似的值、短字符串或经常更新的字符串列

11. 【遗忘】查询计划中，什么关键字表示全表扫描？

答：

12. 【不合格】哪些业务场景不适合建索引？



## 8 运维

### 8.1 jenkins

1. 【盲区】描述一下 jenkins 的自动构建部署流程？

答：

### 8.2 Linux

1. 【盲区】linux 下一切皆文件，这是与 windows 的最大区别，你是怎么理解这句话的？

答：linux为了实现一切皆文件的设计哲学，不仅将数据抽象成了文件，也将一切操作和资源抽象成了文件，比如说硬件设备，socket，磁盘，进程，线程等，这样的设计将系统的所有动作都统一起来，实现了对系统的原子化操作，大大降低了维护和操作的难度。

2. 【盲区】说一下 linux 的 fd，文件描述符（file descriptor）的作用。

答：fd 在系统里面是一个非负的整数。每打开或创建一个文件，内核就会向进程返回一个fd，第一个打开文件是0,第二个是1,依次递增，即文件的脚标。

3. 【不合格】在某个日志目录下，有多个日志文件，我要在这些日志文件中统计某个关键字如“success”出现了多少次，用命令怎么来统计？

答：

4. 【遗忘】如何用进程的端口号去查询进程的PID？

答：`netstat -lnp|grep 8080`

5. 【盲区】awk 命令是干什么的？

答：awk 是一种处理文本文件的语言，是一个强大的文本分析工具。

6. 【记错】怎样给一个文件末尾追加一行记录？

答：`echo '记录' >> 1.txt`

7. 【遗忘】nohup 命令怎样后台输出日志？

### 8.3 Docker

1. 【盲区】如何搭建 docker 集群？

答：用 Swarm 或者 k8s。

2. 【盲区】docker 底层原理了解吗？用了 linux 一些什么命令框架？

答：

### 8.4 nginx

1. 【盲区】说一下 nginx 的常用的配置命令。

答：

2. 【盲区】说一下 nginx 的四种负载均衡策略。

## 9 开发工具

### 9.1 git

1. 【不合格】说一下 git 代码存储的结构。

答：工作区：代码的编写及修改；

​		暂存区：`git add` 将本地修改添加至此；

​		本地仓库：`git commit` 将暂存区的代码提交至此；

​		远程仓库：`git push` 将本地仓库的代码提交至此。

## 10 解决方案

1. 【盲区】公司的核心业务，如果让你去设计一个 API 对内和对外，你会怎么定规范。

答：比如从安全、防刷、大流量熔断方面考虑。

2. 【不合格】验证码的作用？

答：

3. 【不合格】我前端请求时要带一个验证码过来，请求方式是 POST，你如何设计一个 filter 来获请求里的取验证码？这里面会有一些什么问题。

答：

4. 【不合格】如何使用 AOP 的方式来统一处理分页响应数据？

答：

## 11 开发规范

1. 【盲区】说一下你们公司的微服务方面的开发规范，举几个例子。

答：

## 12 工作经验积累

1. 【不合格】你说一下你为什么能拿到这个薪酬？上家你是这么多，你为什么能有这样的增幅？

答：开箱即用，上手就能工作，现有的技术和经验能够相比我刚进上家公司创造更大的价值，省略了刚毕业应届生刚毕业的培训期，行业业务相似，给我一把扳手我就能开始拧螺丝，给我一台电脑，我能快速的搭环境，进入工作状态，还能为公司搭建 k8s + docker 集群，改善公司运维环境。